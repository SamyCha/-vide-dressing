<div class="panel panel-default">
  <div class="panel-body">
<!-- Carousel -->
<div class="row">
  <div class="col-md-10 col-md-offset-1">
    <div id="myCarousel" class="carousel slide" data-ride="carousel">
        <!-- Indicators -->
    <% if @photos %>
    <% @photos.each do |photo| %>
    <ol class="carousel-indicators">
    <li data-target="#myCarousel" data-slide-to="<%= photo.id %>" class="active"></li>
    </ol>
    <% end %>
    <% end %>
        <!-- Wrapper for slides -->
      <div class="carousel-inner" role="listbox">
      <% if @photos %>
      <% @photos.each do |photo| %>
        <div class="item <%= 'active' if photo.id == @photos[0].id %>">
        <%= image_tag photo.image.url() %>
        </div>
        <% end %>
        <% end %>
      </div>
          <!-- Left and right controls -->
      <a class="left carousel-control" href="#myCarousel" role="button" data-slide="prev">
      <span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>
      <span class="sr-only">Précédent</span>
      </a>
      <a class="right carousel-control" href="#myCarousel" role="button" data-slide="next">
      <span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span>
      <span class="sr-only">Suivant</span>
      </a>
    </div>
  </div>
</div>
</br>


    <!-- Photo principale de l'annonce
<div class="row">
  <div class="col-md-12">
  <%= image_tag @photos[0].image.url(), class:"img-responsive" if @photos.length >0 %>
  </div>
</div>
<br>
-->
    <!-- Informations principales -->
<div class="row">
  <div class="col-md-8">
    <div class="row">
      <div class="col-md-3 text-center">
      <%= image_tag avatar_url(@product.user), class:"img-circle avatar-large" %>
      <br>
      <br>
      <%= @product.user.pseudo %>
      </div>
      <div class="col-md-9">
      <h4><%= @product.name %></h4>
      <%= @product.address %> <a href="#average_rating", class="sidebar-link"><span id="average_rating_header"></span> <%= @reviews.count %></a>
        <div class="row text-center row-space-1">
          <div class="col-sm-3">
          <i class="fa fa-female fa-2x" aria-hidden="true"></i>
          </div>
          <div class="col-sm-3">
          <i class="fa fa-black-tie fa-2x" aria-hidden="true"></i>
          </div>
          <div class="col-sm-3">
          <i class="fa fa-level-up fa-2x" aria-hidden="true"></i>
          </div>
          <div class="col-sm-3">
          <i class="fa fa-adjust fa-2x" aria-hidden="true"></i>
          </div>
        </div>
        <div class="row text-center">
          <div class="col-sm-3">
          CATEGORIE: <%= @product.category %>
          </div>
          <div class="col-sm-3">
          MARQUE: <%= @product.brand %>
          </div>
          <div class="col-sm-3">
          TAILLE: <%= @product.size %>
          </div>
          <div class="col-sm-3">
          COULEUR: <%= @product.color %>
          </div>
        </div>
      </div>
    </div>

  <!-- Description -->
<div class="row">
  <div class="col-md-12">
  <h4>A propos de cet article</h4>
  <p><%= @product.description %></p>
  <p><%= @product.state %></p>
  </div>
</div>

<br>
<hr>

  </div>
  <div class="col-md-4">
  <!-- Formulaire de réservation -->
  <%= render 'reservations/form' %>
  </div>
</div>


<!-- Reviews -->

 <div class="row">
  <div class="col-md-12">
  <h3><%= pluralize(@reviews.count, 'commentaire') %> <span id="average_rating"></span><span id="average_rating"></span>(<%= @reviews.count %>)</h3>
    <div class="container">
      <div>
      <%= render 'reviews/form' if @booked && !@hasReview %>
      </div>
      <div>
      <%= render 'reviews/list' %>
      </div>
    </div>
  </div>
</div>
    <!-- Google maps -->
<div class="row">
  <div class="col-md-12">
    <div id="map"></div>
    <style>
      #map {
      height: 400px;
      width: 100%;
      }</style>
    <script>function initMap() {
      var uluru = {lat: <%= @product.latitude %>, lng: <%= @product.longitude %>};
        var map = new google.maps.Map(document.getElementById('map'), {
          zoom: 15,
          center: uluru
          });
          var marker = new google.maps.Marker({
                      position: uluru,
                      map: map
          });
          }
    </script>
    <script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAgkkYGH99wJ7N-wb_J6HcjTvu9KK-ZFiU&callback=initMap"></script>
  </div>
</div>
<!-- Logements à proximité -->
<h3>Autres articles à proximité...</h3>
<div class="row">
<% for product in @product.nearbys(2).limit(3) %>
  <div class="col-md-4">
    <div class="panel panel-default">
      <div class="panel-heading preview">
      <%= image_tag product.photos[0].image.url(:medium) if product.photos.length > 0 %>
      </div>
      <div class="panel-body">
      <%= link_to product.name, product %><br>
                  (à <%= (product.distance*1.6).round(2) %> km)
      </div>
    </div>
  </div>
  <% end %>
</div>

  </div>
</div>

<script>
  $('#average_rating').raty({
    path: '/assets',
    readOnly: true,
    score: <%= @product.average_rating %>
    });
</script>

<script>
  $('#average_rating_header').raty({
    path: '/assets',
    readOnly: true,
    score: <%= @product.average_rating %>
    });
</script>
